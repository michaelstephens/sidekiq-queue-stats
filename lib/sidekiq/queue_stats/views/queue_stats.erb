<header class="row">
  <div class="col-sm-5">
    <h3>Queue Stats</h3>
  </div>
</header>

<div class="dropdown pull-right">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    Queues
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="?">All</a></li>
    <% @queues.each do |q| %>
      <li><a href=<%="?queue=#{q.downcase}"%>><%= q.capitalize %></a></li>
    <% end %>
  </ul>
</div>

<%= csrf_tag if respond_to?(:csrf_tag) %>
<% if params[:queue] %>
  <h4><%= @queue.name.capitalize %></h4>
  <% if @workers[@queue.name].nil? %>
    <div class="alert alert-success">Nothing waiting in queue</div>
  <% else %>
    <table class="table table-striped table-bordered table-white">
      <thead>
        <tr>
          <th>Name</th>
          <th style="width: 150px">Count</th>
        </tr>
      </thead>
      <% @workers[@queue.name].each do |worker| %>
        <tr>
          <td><%=worker.first%></td>
          <td><%=worker.last%></td>
        </tr>
      <% end %>
    </table>
  <% end %>
<% else %>
  <% if @queues.empty? %>
    <div class="alert alert-success">Nothing waiting in any queue</div>
  <% else %>
    <% @queues.each do |q| %>
      <h4><%= q.capitalize %></h4>
      <% if @workers[q].nil? %>
       <div class="alert alert-success">Nothing waiting in queue</div>
      <% else %>
       <table class="table table-striped table-bordered table-white">
         <thead>
           <tr>
             <th>Name</th>
             <th style="width: 150px">Count</th>
           </tr>
         </thead>
         <% @workers[q].each do |worker| %>
           <tr>
             <td><%=worker.first%></td>
             <td><%=worker.last%></td>
           </tr>
         <% end %>
       </table>
      <% end %>
    <% end %>
  <% end %>
<% end %>
